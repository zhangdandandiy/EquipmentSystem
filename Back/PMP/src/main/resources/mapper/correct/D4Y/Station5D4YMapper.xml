<?xml version="1.0" encoding="UTF8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.pmp.mapper.correct.d4y.Station5D4YMapper">

    <resultMap id="Station5Result" type="com.example.pmp.pojo.correct.d4y.Station5D4Y">
        <result property="Barcode" column="Barcode"/>
        <result property="SCAN_FAI2" column="3DSCAN_FAI2"/>
        <result property="SCAN_FAI2_1" column="3DSCAN_FAI2-1"/>
        <result property="SCAN_FAI2_2" column="3DSCAN_FAI2-2"/>
        <result property="SCAN_FAI2_3" column="3DSCAN_FAI2-3"/>
        <result property="SCAN_FAI2_4" column="3DSCAN_FAI2-4"/>
        <result property="SCAN_FAI2_5" column="3DSCAN_FAI2-5"/>
        <result property="SCAN_FAI2_6" column="3DSCAN_FAI2-6"/>
        <result property="SCAN_FAI2_7" column="3DSCAN_FAI2-7"/>
        <result property="SCAN_FAI2_8" column="3DSCAN_FAI2-8"/>
        <result property="SCAN_FAI2_9" column="3DSCAN_FAI2-9"/>
        <result property="SCAN_FAI2_10" column="3DSCAN_FAI2-10"/>
        <result property="SCAN_FAI2_11" column="3DSCAN_FAI2-11"/>
        <result property="SCAN_FAI2_12" column="3DSCAN_FAI2-12"/>
        <result property="SCAN_FAI2_13" column="3DSCAN_FAI2-13"/>
        <result property="SCAN_FAI2_14" column="3DSCAN_FAI2-14"/>
        <result property="SCAN_FAI2_15" column="3DSCAN_FAI2-15"/>
        <result property="SCAN_FAI2_16" column="3DSCAN_FAI2-16"/>
        <result property="SCAN_FAI2_17" column="3DSCAN_FAI2-17"/>
        <result property="SCAN_FAI2_18" column="3DSCAN_FAI2-18"/>
        <result property="SCAN_FAI2_19" column="3DSCAN_FAI2-19"/>
        <result property="SCAN_FAI2_20" column="3DSCAN_FAI2-20"/>
        <result property="SCAN_FAI2_21" column="3DSCAN_FAI2-21"/>
        <result property="SCAN_FAI2_22" column="3DSCAN_FAI2-22"/>
        <result property="SCAN_FAI2_23" column="3DSCAN_FAI2-23"/>
        <result property="SCAN_FAI2_24" column="3DSCAN_FAI2-24"/>
        <result property="SCAN_FAI2_25" column="3DSCAN_FAI2-25"/>
        <result property="SCAN_FAI2_26" column="3DSCAN_FAI2-26"/>
        <result property="SCAN_FAI2_27" column="3DSCAN_FAI2-27"/>
        <result property="SCAN_FAI2_28" column="3DSCAN_FAI2-28"/>
        <result property="SCAN_FAI2_29" column="3DSCAN_FAI2-29"/>
        <result property="SCAN_FAI2_30" column="3DSCAN_FAI2-30"/>
        <result property="SCAN_FAI2_31" column="3DSCAN_FAI2-31"/>
        <result property="SCAN_FAI2_32" column="3DSCAN_FAI2-32"/>
        <result property="SCAN_FAI2_33" column="3DSCAN_FAI2-33"/>
        <result property="SCAN_FAI2_34" column="3DSCAN_FAI2-34"/>
        <result property="SCAN_FAI2_35" column="3DSCAN_FAI2-35"/>
        <result property="SCAN_FAI2_36" column="3DSCAN_FAI2-36"/>
        <result property="SCAN_FAI2_37" column="3DSCAN_FAI2-37"/>
        <result property="CCD7_FAI1" column="CCD7_FAI1"/>
        <result property="CCD7_FAI26_1" column="CCD7_FAI26-1"/>
        <result property="CCD7_FAI26_2" column="CCD7_FAI26-2"/>
        <result property="CCD7_FAI26_3" column="CCD7_FAI26-3"/>
        <result property="CCD7_FAI26_4" column="CCD7_FAI26-4"/>
        <result property="CCD7_FAI26_5" column="CCD7_FAI26-5"/>
        <result property="CCD7_FAI26_6" column="CCD7_FAI26-6"/>
        <result property="CCD7_FAI26_7" column="CCD7_FAI26-7"/>
        <result property="CCD7_FAI26_8" column="CCD7_FAI26-8"/>
        <result property="CCD7_FAI26_9" column="CCD7_FAI26-9"/>
        <result property="CCD7_FAI26_10" column="CCD7_FAI26-10"/>
        <result property="CCD7_FAI26_11" column="CCD7_FAI26-11"/>
        <result property="CCD7_FAI26_12" column="CCD7_FAI26-12"/>
        <result property="CCD7_FAI26_13" column="CCD7_FAI26-13"/>
        <result property="CCD7_FAI26_14" column="CCD7_FAI26-14"/>
        <result property="CCD7_FAI26_15" column="CCD7_FAI26-15"/>
        <result property="CCD7_FAI26_16" column="CCD7_FAI26-16"/>
        <result property="CCD7_FAI26_17" column="CCD7_FAI26-17"/>
        <result property="CCD7_FAI26_18" column="CCD7_FAI26-18"/>
        <result property="CCD7_FAI26_19" column="CCD7_FAI26-19"/>
        <result property="CCD7_FAI26_20" column="CCD7_FAI26-20"/>
        <result property="CCD7_FAI26_21" column="CCD7_FAI26-21"/>
        <result property="CCD7_FAI26_22" column="CCD7_FAI26-22"/>
        <result property="CCD7_FAI26_23" column="CCD7_FAI26-23"/>
        <result property="CCD7_FAI26_24" column="CCD7_FAI26-24"/>
        <result property="CCD7_FAI26_25" column="CCD7_FAI26-25"/>
        <result property="CCD7_FAI26_26" column="CCD7_FAI26-26"/>
        <result property="CCD7_FAI26_27" column="CCD7_FAI26-27"/>
        <result property="CCD7_FAI26_28" column="CCD7_FAI26-28"/>
        <result property="CCD7_FAI626_1" column="CCD7_FAI626-1"/>
        <result property="CCD7_FAI626_2" column="CCD7_FAI626-2"/>
        <result property="CCD7_FAI626_3" column="CCD7_FAI626-3"/>
        <result property="CCD7_FAI626_4" column="CCD7_FAI626-4"/>
        <result property="CCD7_FAI626_5" column="CCD7_FAI626-5"/>
        <result property="CCD7_FAI626_6" column="CCD7_FAI626-6"/>
        <result property="CCD7_FAI626_7" column="CCD7_FAI626-7"/>
        <result property="CCD7_FAI626_8" column="CCD7_FAI626-8"/>
        <result property="CCD7_FAI626_9" column="CCD7_FAI626-9"/>
        <result property="CCD7_FAI626_10" column="CCD7_FAI626-10"/>
        <result property="CCD7_FAI626_11" column="CCD7_FAI626-11"/>
        <result property="CCD7_FAI626_12" column="CCD7_FAI626-12"/>
        <result property="CCD7_FAI626_13" column="CCD7_FAI626-13"/>
        <result property="CCD7_FAI626_14" column="CCD7_FAI626-14"/>
        <result property="CCD7_FAI626_15" column="CCD7_FAI626-15"/>
        <result property="CCD7_FAI626_16" column="CCD7_FAI626-16"/>
        <result property="CCD7_FAI626_17" column="CCD7_FAI626-17"/>
        <result property="CCD7_FAI626_18" column="CCD7_FAI626-18"/>
        <result property="CCD7_FAI626_19" column="CCD7_FAI626-19"/>
        <result property="CCD7_FAI626_20" column="CCD7_FAI626-20"/>
        <result property="CCD7_FAI626_21" column="CCD7_FAI626-21"/>
        <result property="CCD7_FAI626_22" column="CCD7_FAI626-22"/>
        <result property="CCD7_FAI626_23" column="CCD7_FAI626-23"/>
        <result property="CCD7_FAI626_24" column="CCD7_FAI626-24"/>
        <result property="CCD7_FAI626_25" column="CCD7_FAI626-25"/>
        <result property="CCD7_FAI626_26" column="CCD7_FAI626-26"/>
        <result property="CCD7_FAI626_27" column="CCD7_FAI626-27"/>
        <result property="CCD7_FAI626_28" column="CCD7_FAI626-28"/>
        <result property="CCD7_FAI24_1" column="CCD7_FAI24-1"/>
        <result property="CCD7_FAI24_2" column="CCD7_FAI24-2"/>
        <result property="CCD7_FAI720_1" column="CCD7_FAI720-1"/>
        <result property="CCD7_FAI720_2" column="CCD7_FAI720-2"/>
        <result property="CCD7_FAI724_1" column="CCD7_FAI724-1"/>
        <result property="CCD7_FAI724_2" column="CCD7_FAI724-2"/>
        <result property="CCD7_FAI725_1" column="CCD7_FAI725-1"/>
        <result property="CCD7_FAI725_2" column="CCD7_FAI725-2"/>
        <result property="CCD7_FAI12" column="CCD7_FAI12"/>
        <result property="TestResult" column="TestResult"/>
        <result property="TestTime" column="TestTime"/>
        <result property="ModuleID" column="ModuleID"/>
        <result property="LineID" column="LineID"/>
        <result property="LineType" column="LineType"/>
        <result property="rn" column="rn"/>
    </resultMap>

    <!-- 从视图里捞取需要补正的数据集合 -->
    <select id="getStation5ListByTime" parameterType="String" resultMap="Station5Result">
        SELECT [Barcode]
             , [3DSCAN_FAI2]
             , [3DSCAN_FAI2-1]
             , [3DSCAN_FAI2-2]
             , [3DSCAN_FAI2-3]
             , [3DSCAN_FAI2-4]
             , [3DSCAN_FAI2-5]
             , [3DSCAN_FAI2-6]
             , [3DSCAN_FAI2-7]
             , [3DSCAN_FAI2-8]
             , [3DSCAN_FAI2-9]
             , [3DSCAN_FAI2-10]
             , [3DSCAN_FAI2-11]
             , [3DSCAN_FAI2-12]
             , [3DSCAN_FAI2-13]
             , [3DSCAN_FAI2-14]
             , [3DSCAN_FAI2-15]
             , [3DSCAN_FAI2-16]
             , [3DSCAN_FAI2-17]
             , [3DSCAN_FAI2-18]
             , [3DSCAN_FAI2-19]
             , [3DSCAN_FAI2-20]
             , [3DSCAN_FAI2-21]
             , [3DSCAN_FAI2-22]
             , [3DSCAN_FAI2-23]
             , [3DSCAN_FAI2-24]
             , [3DSCAN_FAI2-25]
             , [3DSCAN_FAI2-26]
             , [3DSCAN_FAI2-27]
             , [3DSCAN_FAI2-28]
             , [3DSCAN_FAI2-29]
             , [3DSCAN_FAI2-30]
             , [3DSCAN_FAI2-31]
             , [3DSCAN_FAI2-32]
             , [3DSCAN_FAI2-33]
             , [3DSCAN_FAI2-34]
             , [3DSCAN_FAI2-35]
             , [3DSCAN_FAI2-36]
             , [3DSCAN_FAI2-37]
             , [CCD7_FAI1]
             , [CCD7_FAI26-1]
             , [CCD7_FAI26-2]
             , [CCD7_FAI26-3]
             , [CCD7_FAI26-4]
             , [CCD7_FAI26-5]
             , [CCD7_FAI26-6]
             , [CCD7_FAI26-7]
             , [CCD7_FAI26-8]
             , [CCD7_FAI26-9]
             , [CCD7_FAI26-10]
             , [CCD7_FAI26-11]
             , [CCD7_FAI26-12]
             , [CCD7_FAI26-13]
             , [CCD7_FAI26-14]
             , [CCD7_FAI26-15]
             , [CCD7_FAI26-16]
             , [CCD7_FAI26-17]
             , [CCD7_FAI26-18]
             , [CCD7_FAI26-19]
             , [CCD7_FAI26-20]
             , [CCD7_FAI26-21]
             , [CCD7_FAI26-22]
             , [CCD7_FAI26-23]
             , [CCD7_FAI26-24]
             , [CCD7_FAI26-25]
             , [CCD7_FAI26-26]
             , [CCD7_FAI26-27]
             , [CCD7_FAI26-28]
             , [CCD7_FAI626-1]
             , [CCD7_FAI626-2]
             , [CCD7_FAI626-3]
             , [CCD7_FAI626-4]
             , [CCD7_FAI626-5]
             , [CCD7_FAI626-6]
             , [CCD7_FAI626-7]
             , [CCD7_FAI626-8]
             , [CCD7_FAI626-9]
             , [CCD7_FAI626-10]
             , [CCD7_FAI626-11]
             , [CCD7_FAI626-12]
             , [CCD7_FAI626-13]
             , [CCD7_FAI626-14]
             , [CCD7_FAI626-15]
             , [CCD7_FAI626-16]
             , [CCD7_FAI626-17]
             , [CCD7_FAI626-18]
             , [CCD7_FAI626-19]
             , [CCD7_FAI626-20]
             , [CCD7_FAI626-21]
             , [CCD7_FAI626-22]
             , [CCD7_FAI626-23]
             , [CCD7_FAI626-24]
             , [CCD7_FAI626-25]
             , [CCD7_FAI626-26]
             , [CCD7_FAI626-27]
             , [CCD7_FAI626-28]
             , [CCD7_FAI17]
             , [CCD7_FAI24-1]
             , [CCD7_FAI24-2]
             , [CCD7_FAI720-1]
             , [CCD7_FAI720-2]
             , [CCD7_FAI724-1]
             , [CCD7_FAI724-2]
             , [CCD7_FAI725-1]
             , [CCD7_FAI725-2]
             , [CCD7_FAI12]
             , [TestResult]
             , [TestTime]
             , [ModuleID]
             , [LineID]
             , [LineType]
             , [rn]
        FROM [MESDataCenter].[dbo].[m_D4Y_MainLine3_M10_v]
        WHERE convert(varchar, TestTime, 121) between #{startTime} and #{endTime}
          AND Barcode NOT LIKE '%\u0000%'
          AND Barcode NOT LIKE '%?%'
          AND Barcode NOT LIKE '%ERROR%'
          AND Barcode != ''
    </select>

    <!-- 插入补正后的数据，插入到补正表里 -->
    <insert id="insertStation5">
        insert into [MESDataCenter].[dbo].[m_D4Y_MainLine3_M10_BZ_t]
        ( [Barcode]
        , [3DSCAN_FAI2]
        , [3DSCAN_FAI2-1]
        , [3DSCAN_FAI2-2]
        , [3DSCAN_FAI2-3]
        , [3DSCAN_FAI2-4]
        , [3DSCAN_FAI2-5]
        , [3DSCAN_FAI2-6]
        , [3DSCAN_FAI2-7]
        , [3DSCAN_FAI2-8]
        , [3DSCAN_FAI2-9]
        , [3DSCAN_FAI2-10]
        , [3DSCAN_FAI2-11]
        , [3DSCAN_FAI2-12]
        , [3DSCAN_FAI2-13]
        , [3DSCAN_FAI2-14]
        , [3DSCAN_FAI2-15]
        , [3DSCAN_FAI2-16]
        , [3DSCAN_FAI2-17]
        , [3DSCAN_FAI2-18]
        , [3DSCAN_FAI2-19]
        , [3DSCAN_FAI2-20]
        , [3DSCAN_FAI2-21]
        , [3DSCAN_FAI2-22]
        , [3DSCAN_FAI2-23]
        , [3DSCAN_FAI2-24]
        , [3DSCAN_FAI2-25]
        , [3DSCAN_FAI2-26]
        , [3DSCAN_FAI2-27]
        , [3DSCAN_FAI2-28]
        , [3DSCAN_FAI2-29]
        , [3DSCAN_FAI2-30]
        , [3DSCAN_FAI2-31]
        , [3DSCAN_FAI2-32]
        , [3DSCAN_FAI2-33]
        , [3DSCAN_FAI2-34]
        , [3DSCAN_FAI2-35]
        , [3DSCAN_FAI2-36]
        , [3DSCAN_FAI2-37]
        , [CCD7_FAI1]
        , [CCD7_FAI26-1]
        , [CCD7_FAI26-2]
        , [CCD7_FAI26-3]
        , [CCD7_FAI26-4]
        , [CCD7_FAI26-5]
        , [CCD7_FAI26-6]
        , [CCD7_FAI26-7]
        , [CCD7_FAI26-8]
        , [CCD7_FAI26-9]
        , [CCD7_FAI26-10]
        , [CCD7_FAI26-11]
        , [CCD7_FAI26-12]
        , [CCD7_FAI26-13]
        , [CCD7_FAI26-14]
        , [CCD7_FAI26-15]
        , [CCD7_FAI26-16]
        , [CCD7_FAI26-17]
        , [CCD7_FAI26-18]
        , [CCD7_FAI26-19]
        , [CCD7_FAI26-20]
        , [CCD7_FAI26-21]
        , [CCD7_FAI26-22]
        , [CCD7_FAI26-23]
        , [CCD7_FAI26-24]
        , [CCD7_FAI26-25]
        , [CCD7_FAI26-26]
        , [CCD7_FAI26-27]
        , [CCD7_FAI26-28]
        , [CCD7_FAI626-1]
        , [CCD7_FAI626-2]
        , [CCD7_FAI626-3]
        , [CCD7_FAI626-4]
        , [CCD7_FAI626-5]
        , [CCD7_FAI626-6]
        , [CCD7_FAI626-7]
        , [CCD7_FAI626-8]
        , [CCD7_FAI626-9]
        , [CCD7_FAI626-10]
        , [CCD7_FAI626-11]
        , [CCD7_FAI626-12]
        , [CCD7_FAI626-13]
        , [CCD7_FAI626-14]
        , [CCD7_FAI626-15]
        , [CCD7_FAI626-16]
        , [CCD7_FAI626-17]
        , [CCD7_FAI626-18]
        , [CCD7_FAI626-19]
        , [CCD7_FAI626-20]
        , [CCD7_FAI626-21]
        , [CCD7_FAI626-22]
        , [CCD7_FAI626-23]
        , [CCD7_FAI626-24]
        , [CCD7_FAI626-25]
        , [CCD7_FAI626-26]
        , [CCD7_FAI626-27]
        , [CCD7_FAI626-28]
        , [CCD7_FAI17]
        , [CCD7_FAI24-1]
        , [CCD7_FAI24-2]
        , [CCD7_FAI720-1]
        , [CCD7_FAI720-2]
        , [CCD7_FAI724-1]
        , [CCD7_FAI724-2]
        , [CCD7_FAI725-1]
        , [CCD7_FAI725-2]
        , [CCD7_FAI12]
        , [TestResult]
        , [TestTime]
        , [ModuleID]
        , [LineID]
        , [LineType]
        , [rn])
        values ( #{Barcode}
               , #{SCAN_FAI2}
               , #{SCAN_FAI2_1}
               , #{SCAN_FAI2_2}
               , #{SCAN_FAI2_3}
               , #{SCAN_FAI2_4}
               , #{SCAN_FAI2_5}
               , #{SCAN_FAI2_6}
               , #{SCAN_FAI2_7}
               , #{SCAN_FAI2_8}
               , #{SCAN_FAI2_9}
               , #{SCAN_FAI2_10}
               , #{SCAN_FAI2_11}
               , #{SCAN_FAI2_12}
               , #{SCAN_FAI2_13}
               , #{SCAN_FAI2_14}
               , #{SCAN_FAI2_15}
               , #{SCAN_FAI2_16}
               , #{SCAN_FAI2_17}
               , #{SCAN_FAI2_18}
               , #{SCAN_FAI2_19}
               , #{SCAN_FAI2_20}
               , #{SCAN_FAI2_21}
               , #{SCAN_FAI2_22}
               , #{SCAN_FAI2_23}
               , #{SCAN_FAI2_24}
               , #{SCAN_FAI2_25}
               , #{SCAN_FAI2_26}
               , #{SCAN_FAI2_27}
               , #{SCAN_FAI2_28}
               , #{SCAN_FAI2_29}
               , #{SCAN_FAI2_30}
               , #{SCAN_FAI2_31}
               , #{SCAN_FAI2_32}
               , #{SCAN_FAI2_33}
               , #{SCAN_FAI2_34}
               , #{SCAN_FAI2_35}
               , #{SCAN_FAI2_36}
               , #{SCAN_FAI2_37}
               , #{CCD7_FAI1}
               , #{CCD7_FAI26_1}
               , #{CCD7_FAI26_2}
               , #{CCD7_FAI26_3}
               , #{CCD7_FAI26_4}
               , #{CCD7_FAI26_5}
               , #{CCD7_FAI26_6}
               , #{CCD7_FAI26_7}
               , #{CCD7_FAI26_8}
               , #{CCD7_FAI26_9}
               , #{CCD7_FAI26_10}
               , #{CCD7_FAI26_11}
               , #{CCD7_FAI26_12}
               , #{CCD7_FAI26_13}
               , #{CCD7_FAI26_14}
               , #{CCD7_FAI26_15}
               , #{CCD7_FAI26_16}
               , #{CCD7_FAI26_17}
               , #{CCD7_FAI26_18}
               , #{CCD7_FAI26_19}
               , #{CCD7_FAI26_20}
               , #{CCD7_FAI26_21}
               , #{CCD7_FAI26_22}
               , #{CCD7_FAI26_23}
               , #{CCD7_FAI26_24}
               , #{CCD7_FAI26_25}
               , #{CCD7_FAI26_26}
               , #{CCD7_FAI26_27}
               , #{CCD7_FAI26_28}
               , #{CCD7_FAI626_1}
               , #{CCD7_FAI626_2}
               , #{CCD7_FAI626_3}
               , #{CCD7_FAI626_4}
               , #{CCD7_FAI626_5}
               , #{CCD7_FAI626_6}
               , #{CCD7_FAI626_7}
               , #{CCD7_FAI626_8}
               , #{CCD7_FAI626_9}
               , #{CCD7_FAI626_10}
               , #{CCD7_FAI626_11}
               , #{CCD7_FAI626_12}
               , #{CCD7_FAI626_13}
               , #{CCD7_FAI626_14}
               , #{CCD7_FAI626_15}
               , #{CCD7_FAI626_16}
               , #{CCD7_FAI626_17}
               , #{CCD7_FAI626_18}
               , #{CCD7_FAI626_19}
               , #{CCD7_FAI626_20}
               , #{CCD7_FAI626_21}
               , #{CCD7_FAI626_22}
               , #{CCD7_FAI626_23}
               , #{CCD7_FAI626_24}
               , #{CCD7_FAI626_25}
               , #{CCD7_FAI626_26}
               , #{CCD7_FAI626_27}
               , #{CCD7_FAI626_28}
               , #{CCD7_FAI17}
               , #{CCD7_FAI24_1}
               , #{CCD7_FAI24_2}
               , #{CCD7_FAI720_1}
               , #{CCD7_FAI720_2}
               , #{CCD7_FAI724_1}
               , #{CCD7_FAI724_2}
               , #{CCD7_FAI725_1}
               , #{CCD7_FAI725_2}
               , #{CCD7_FAI12}
               , #{TestResult}
               , #{TestTime}
               , #{ModuleID}
               , #{LineID}
               , #{LineType}
               , #{rn})
    </insert>

    <select id="getStation5SNList" parameterType="String" resultType="String">
        select Barcode
        from [MESDataCenter].[dbo].[m_D4Y_MainLine3_M10_v]
        where convert(varchar, TestTime, 121) between #{startTime} and #{endTime}
          AND Barcode NOT LIKE '%\u0000%'
          AND Barcode NOT LIKE '%?%'
          AND Barcode NOT LIKE '%ERROR%'
          AND Barcode != ''
    </select>

</mapper>
